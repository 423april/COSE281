% COSEclear allclose allclcload abalone.mat%% Data Manipulation% separate the dependent and independent variables% construct full data matrix (the first column is discarded)data = table2array(abalone(:, 2 : 8));% obtain labels (age = rings + 1.5)age = table2array(abalone(:, 9)) + 1.5;%% Artificial Neural Network Training% approximately 70% of the data are used for training; the rest are used for% validationsz_training = floor(0.7 * size(data, 1));% generate random indices to use for trainingrandom_indices = randperm(size(data, 1));% generate training and validation data using random indicestraining_data = data(random_indices(1 : sz_training), :);validation_data = data(random_indices(sz_training + 1 : end), :);training_age = age(random_indices(1 : sz_training));validation_age = age(random_indices(sz_training + 1 : end));% set up the network; the following model gave the best resultsnet = fitnet([20 20 20 20]);net.trainParam.showWindow = false;net.trainParam.showCommandLine = false;% train the networktrained_net = train(net, training_data', training_age');% calculate sse using unseen datapred_age = trained_net(validation_data(:, :)');rmse = sqrt(sum((pred_age - validation_age') .^ 2) / size(validation_age, 1))