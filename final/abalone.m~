load abalone.mat% labelCount = array2table(sum(labels == types), 'VariableNames', type_names)% size(images(:, :, 1))% process the datasex = table2array(abalone(:, 1));sex = grp2idx(sex);data = concat(sextable2array(abalone(:, 2 : 8));age = table2array(abalone(:, 9)) + 1.5;%%% approximately 90% of images are used for training; the rest are used for% validationtrainNumFiles = floor(0.9 * size(data, 3));% generate random indices to use for trainingrandom_indices = randperm(size(data, 3));% generate training and validation data using random indices% since trainNetwork takes a 4-D numeric array (explained in further detail% below), the data is reshaped to denote the presence of 1 channel.%trainImageData = reshape([data(:, :, random_indices(1 : trainNumFiles))], [28 28 1 trainNumFiles]);%valImageData = reshape([data(:, :, random_indices(trainNumFiles + 1 : end))], [28 28 1 size(images, 3) - trainNumFiles]);% define categorical labels for later usetrainCategories = categorical(labels(random_indices(1 : trainNumFiles)));valCategories = categorical(labels(random_indices(trainNumFiles + 1 : end)));layers = [    imageInputLayer([28 28 1])        convolution2dLayer(3,16,'Padding',1)    batchNormalizationLayer    reluLayer        maxPooling2dLayer(2,'Stride',2)        convolution2dLayer(3,16,'Padding',1)    batchNormalizationLayer    reluLayer        maxPooling2dLayer(2,'Stride',2)        convolution2dLayer(3,16,'Padding',1)    batchNormalizationLayer    reluLayer        fullyConnectedLayer(5)    softmaxLayer    classificationLayer];options = trainingOptions('sgdm',...    'MaxEpochs', 3, ... % change the number of epochs to 10 for increased accuracy    'ValidationData',{valImageData valCategories},... % ValidationData has been changed into a custom cell array    'ValidationFrequency', 30,...    'Verbose',true,...    'Plots','training-progress','ExecutionEnvironment','cpu');predictedLabels = classify(net,valImageData);valLabels = valCategories;accuracy = sum(predictedLabels == valLabels)/numel(valLabels)